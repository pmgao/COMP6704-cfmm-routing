import os
import re
import matplotlib.pyplot as plt
from matplotlib.gridspec import GridSpec

text_8x12 = r"""
iter    pcost        dcost       gap       pres      dres      k/t        μ       step      
---------------------------------------------------------------------------------------------
  0  +0.0000e+00  -3.0533e+08  3.05e+08  2.83e+00  7.67e-01  1.00e+00  1.00e+00   ------   
  1  -1.0836e+00  -3.0533e+08  2.82e+08  2.83e+00  2.74e-01  2.58e+00  3.87e-01  7.48e-01  
  2  -7.6147e+00  -3.0533e+08  4.01e+07  2.83e+00  5.89e-02  9.97e+00  1.00e-01  7.90e-01  
  3  -3.8003e+01  -3.0532e+08  8.03e+06  2.83e+00  1.19e-02  4.45e+01  2.25e-02  7.92e-01  
  4  -1.7562e+02  -3.0530e+08  1.74e+06  2.83e+00  2.51e-03  2.00e+02  5.00e-03  7.86e-01  
  5  -8.2193e+02  -3.0521e+08  3.71e+05  2.83e+00  5.18e-04  9.30e+02  1.07e-03  7.92e-01  
  6  -3.8149e+03  -3.0476e+08  7.99e+04  2.80e+00  1.08e-04  4.31e+03  2.31e-04  7.92e-01  
  7  -1.7625e+04  -3.0269e+08  1.72e+04  2.69e+00  2.28e-05  1.99e+04  4.98e-05  7.92e-01  
  8  -7.9694e+04  -2.9353e+08  3.68e+03  2.26e+00  4.87e-06  8.77e+04  1.08e-05  7.91e-01  
  9  -3.1695e+05  -2.6030e+08  8.20e+02  1.35e+00  1.14e-06  3.12e+05  2.52e-06  7.74e-01  
 10  -1.5007e+06  -1.3192e+08  8.69e+01  3.09e-01  1.60e-07  8.67e+05  3.46e-07  8.65e-01  
 11  -8.7073e+06  -5.9812e+07  5.87e+00  8.97e-02  4.37e-08  2.81e+05  9.55e-08  9.90e-01  
 12  -1.0320e+07  -3.1563e+07  2.06e+00  3.35e-02  1.49e-08  1.28e+05  3.45e-08  6.83e-01  
 13  -1.0958e+07  -1.8284e+07  6.69e-01  1.10e-02  4.85e-09  4.38e+04  1.13e-08  7.32e-01  
 14  -1.1321e+07  -1.3627e+07  2.04e-01  3.40e-03  1.54e-09  1.40e+04  3.59e-09  7.92e-01  
 15  -1.1520e+07  -1.2047e+07  4.57e-02  7.75e-04  3.57e-10  3.48e+03  8.22e-10  9.90e-01  
 16  -1.1510e+07  -1.1668e+07  1.37e-02  2.33e-04  1.17e-10  1.04e+03  2.46e-10  7.92e-01  
 17  -1.1478e+07  -1.1506e+07  2.43e-03  4.14e-05  8.65e-11  1.79e+02  4.59e-11  9.90e-01  
 18  -1.1457e+07  -1.1467e+07  8.16e-04  1.39e-05  8.15e-11  6.66e+01  2.07e-11  9.90e-01  
 19  -1.1434e+07  -1.1438e+07  3.53e-04  6.02e-06  6.96e-11  3.46e+01  1.13e-11  7.92e-01  
 20  -1.1425e+07  -1.1427e+07  1.54e-04  2.64e-06  4.55e-11  2.23e+01  8.06e-12  9.90e-01  
 21  -1.1416e+07  -1.1416e+07  7.27e-05  1.25e-06  3.99e-11  1.17e+01  4.58e-12  6.13e-01  
 22  -1.1407e+07  -1.1407e+07  2.86e-05  4.98e-07  3.62e-11  8.38e+00  2.97e-12  9.90e-01  
 23  -1.1405e+07  -1.1406e+07  1.71e-05  2.99e-07  3.41e-11  5.61e+00  2.08e-12  5.07e-01  
 24  -1.1403e+07  -1.1403e+07  5.85e-06  1.03e-07  3.31e-11  2.49e+00  9.35e-13  7.92e-01  
 25  -1.1401e+07  -1.1401e+07  1.55e-06  2.83e-08  3.29e-11  1.18e+00  4.47e-13  9.90e-01  
 26  -1.1400e+07  -1.1400e+07  1.17e-06  2.16e-08  3.28e-11  1.05e+00  4.11e-13  4.06e-01  
 27  -1.1400e+07  -1.1400e+07  7.03e-07  1.31e-08  3.27e-11  6.94e-01  3.01e-13  4.60e-01  
 28  -1.1398e+07  -1.1398e+07  2.87e-07  5.89e-09  3.20e-11  6.24e-01  2.39e-13  9.90e-01  
 29  -1.1398e+07  -1.1398e+07  1.60e-07  3.36e-09  3.20e-11  3.93e-01  1.67e-13  5.07e-01  
 30  -1.1397e+07  -1.1397e+07  4.22e-08  1.13e-09  3.19e-11  2.57e-01  9.53e-14  9.90e-01  
 31  -1.1397e+07  -1.1397e+07  2.42e-08  7.04e-10  3.19e-11  1.85e-01  7.69e-14  5.07e-01  
 32  -1.1397e+07  -1.1397e+07  1.79e-08  5.98e-10  3.19e-11  1.87e-01  7.90e-14  3.24e-01  
 33  -1.1397e+07  -1.1397e+07  1.10e-08  4.82e-10  3.19e-11  1.90e-01  7.54e-14  4.06e-01  
 34  -1.1397e+07  -1.1397e+07  4.48e-09  3.82e-10  3.19e-11  1.98e-01  7.32e-14  5.07e-01  
"""

text_32x100 = r"""
iter    pcost        dcost       gap       pres      dres      k/t        μ       step      
---------------------------------------------------------------------------------------------
  0  +0.0000e+00  -2.0827e+09  2.08e+09  7.21e+00  8.19e-01  1.00e+00  1.00e+00   ------   
  1  -1.0815e+00  -2.0827e+09  1.93e+09  7.21e+00  3.36e-01  2.25e+00  4.45e-01  7.15e-01  
  2  -7.4845e+00  -2.0827e+09  2.78e+08  7.21e+00  7.54e-02  8.19e+00  1.22e-01  7.92e-01  
  3  -3.7426e+01  -2.0827e+09  5.56e+07  7.21e+00  1.53e-02  3.60e+01  2.78e-02  7.92e-01  
  4  -1.7568e+02  -2.0826e+09  1.19e+07  7.21e+00  3.24e-03  1.61e+02  6.21e-03  7.87e-01  
  5  -8.2125e+02  -2.0821e+09  2.54e+06  7.18e+00  6.68e-04  7.48e+02  1.34e-03  7.92e-01  
  6  -3.8358e+03  -2.0798e+09  5.42e+05  7.06e+00  1.40e-04  3.47e+03  2.88e-04  7.92e-01  
  7  -1.7719e+04  -2.0693e+09  1.17e+05  6.56e+00  2.94e-05  1.60e+04  6.20e-05  7.92e-01  
  8  -8.1118e+04  -2.0220e+09  2.49e+04  4.93e+00  6.25e-06  7.16e+04  1.34e-05  7.92e-01  
  9  -3.3250e+05  -1.8442e+09  5.55e+03  2.42e+00  1.45e-06  2.67e+05  3.12e-06  7.75e-01  
 10  -1.7377e+06  -1.0914e+09  6.27e+02  4.92e-01  2.20e-07  8.64e+05  4.62e-07  8.55e-01  
 11  -1.5207e+07  -6.0314e+08  3.87e+01  1.87e-01  8.44e-08  3.94e+05  1.74e-07  9.90e-01  
 12  -2.1944e+07  -2.5421e+08  1.06e+01  6.08e-02  2.70e-08  1.79e+05  5.60e-08  6.89e-01  
 13  -2.5521e+07  -1.0822e+08  3.24e+00  2.07e-02  9.93e-09  5.87e+04  2.00e-08  7.21e-01  
 14  -2.7612e+07  -6.9183e+07  1.51e+00  1.06e-02  6.03e-09  2.86e+04  1.14e-08  5.84e-01  
 15  -2.9034e+07  -4.7543e+07  6.37e-01  4.80e-03  3.27e-09  1.22e+04  5.84e-09  6.08e-01  
 16  -2.9986e+07  -3.9813e+07  3.28e-01  2.54e-03  2.03e-09  6.54e+03  3.47e-09  6.00e-01  
 17  -3.0779e+07  -3.4524e+07  1.22e-01  9.57e-04  9.38e-10  2.48e+03  1.45e-09  7.92e-01  
 18  -3.1276e+07  -3.3103e+07  5.84e-02  4.54e-04  5.71e-10  1.19e+03  7.43e-10  7.92e-01  
 19  -3.1645e+07  -3.2624e+07  3.09e-02  2.37e-04  3.89e-10  6.46e+02  4.13e-10  7.92e-01  
 20  -3.1916e+07  -3.2281e+07  1.14e-02  8.59e-05  2.65e-10  2.45e+02  1.64e-10  7.92e-01  
 21  -3.2243e+07  -3.2376e+07  4.13e-03  3.04e-05  1.87e-10  1.01e+02  7.04e-11  9.90e-01  
 22  -3.2382e+07  -3.2435e+07  1.66e-03  1.22e-05  1.35e-10  5.01e+01  3.47e-11  9.90e-01  
 23  -3.2467e+07  -3.2503e+07  1.11e-03  8.05e-06  1.13e-10  3.55e+01  2.55e-11  5.07e-01  
 24  -3.2587e+07  -3.2597e+07  3.26e-04  2.35e-06  7.89e-11  1.23e+01  9.02e-12  8.69e-01  
 25  -3.2638e+07  -3.2645e+07  2.07e-04  1.49e-06  6.64e-11  8.46e+00  6.51e-12  5.07e-01  
 26  -3.2673e+07  -3.2677e+07  1.29e-04  9.28e-07  5.66e-11  5.56e+00  4.44e-12  4.53e-01  
 27  -3.2730e+07  -3.2731e+07  2.87e-05  2.06e-07  4.16e-11  1.65e+00  1.26e-12  9.24e-01  
 28  -3.2761e+07  -3.2762e+07  1.02e-05  7.30e-08  3.45e-11  8.43e-01  6.42e-13  9.90e-01  
 29  -3.2764e+07  -3.2764e+07  8.97e-06  6.43e-08  3.33e-11  7.65e-01  5.90e-13  1.77e-01  
 30  -3.2769e+07  -3.2769e+07  6.59e-06  4.73e-08  3.07e-11  6.14e-01  4.79e-13  4.06e-01  
 31  -3.2774e+07  -3.2774e+07  5.02e-06  3.60e-08  2.88e-11  4.94e-01  3.95e-13  3.24e-01  
 32  -3.2780e+07  -3.2780e+07  3.25e-06  2.33e-08  2.65e-11  3.34e-01  2.81e-13  4.06e-01  
 33  -3.2786e+07  -3.2786e+07  2.16e-06  1.55e-08  2.47e-11  2.37e-01  2.07e-13  4.06e-01  
 34  -3.2791e+07  -3.2791e+07  1.33e-06  9.51e-09  2.30e-11  1.65e-01  1.46e-13  5.07e-01  
 35  -3.2792e+07  -3.2792e+07  1.17e-06  8.37e-09  2.26e-11  1.69e-01  1.39e-13  3.24e-01  
 36  -3.2795e+07  -3.2795e+07  8.37e-07  6.01e-09  2.15e-11  1.33e-01  1.11e-13  4.06e-01  
 37  -3.2797e+07  -3.2797e+07  5.95e-07  4.27e-09  2.06e-11  1.04e-01  8.83e-14  4.06e-01  
 38  -3.2800e+07  -3.2800e+07  4.11e-07  2.95e-09  1.98e-11  7.83e-02  6.82e-14  4.06e-01  
 39  -3.2801e+07  -3.2801e+07  3.19e-07  2.29e-09  1.92e-11  6.61e-02  5.82e-14  3.24e-01  
 40  -3.2803e+07  -3.2803e+07  2.13e-07  1.53e-09  1.84e-11  4.67e-02  3.91e-14  3.84e-01  
 41  -3.2803e+07  -3.2803e+07  2.04e-07  1.47e-09  1.84e-11  4.65e-02  3.88e-14  1.06e-01  
 42  -3.2805e+07  -3.2805e+07  1.35e-07  9.69e-10  1.78e-11  3.55e-02  3.10e-14  5.07e-01  
 43  -3.2805e+07  -3.2805e+07  1.17e-07  8.42e-10  1.76e-11  3.39e-02  2.95e-14  2.60e-01  
 44  -3.2806e+07  -3.2806e+07  8.80e-08  6.34e-10  1.73e-11  2.92e-02  2.56e-14  4.06e-01  
 45  -3.2806e+07  -3.2806e+07  7.83e-08  5.65e-10  1.71e-11  2.80e-02  2.47e-14  2.08e-01  
 46  -3.2807e+07  -3.2807e+07  6.95e-08  5.01e-10  1.69e-11  2.67e-02  2.36e-14  2.08e-01  
 47  -3.2808e+07  -3.2808e+07  4.55e-08  3.30e-10  1.66e-11  2.60e-02  2.13e-14  7.92e-01  
 48  -3.2808e+07  -3.2808e+07  3.95e-08  2.87e-10  1.64e-11  2.38e-02  1.98e-14  2.08e-01  
 49  -3.2808e+07  -3.2808e+07  3.55e-08  2.58e-10  1.63e-11  2.24e-02  1.90e-14  1.66e-01  
 50  -3.2808e+07  -3.2808e+07  3.19e-08  2.32e-10  1.62e-11  2.16e-02  1.84e-14  2.08e-01  
 51  -3.2808e+07  -3.2808e+07  3.12e-08  2.28e-10  1.61e-11  2.24e-02  1.88e-14  1.06e-01  
 52  -3.2808e+07  -3.2808e+07  3.12e-08  2.28e-10  1.61e-11  2.24e-02  1.88e-14  0.00e+00  
 53  -3.2808e+07  -3.2808e+07  3.12e-08  2.27e-10  1.63e-11  2.27e-02  1.92e-14  2.79e-02  
 54  -3.2808e+07  -3.2808e+07  3.12e-08  2.27e-10  1.63e-11  2.28e-02  1.79e-14  4.54e-04  
 55  -3.2808e+07  -3.2808e+07  3.12e-08  2.27e-10  1.62e-11  2.28e-02  1.76e-14  1.35e-03  
 56  -3.2808e+07  -3.2808e+07  3.12e-08  2.27e-10  1.61e-11  2.28e-02  1.75e-14  2.91e-03  
 57  -3.2808e+07  -3.2808e+07  3.11e-08  2.27e-10  1.61e-11  2.28e-02  1.74e-14  7.30e-03  
 58  -3.2808e+07  -3.2808e+07  3.09e-08  2.26e-10  1.61e-11  2.31e-02  1.81e-14  4.35e-02  
 59  -3.2808e+07  -3.2808e+07  3.09e-08  3.55e-10  1.61e-11  2.34e-02  1.75e-14  3.48e-02  
 60  -3.2808e+07  -3.2808e+07  3.04e-08  6.37e-10  1.60e-11  2.40e-02  1.73e-14  1.06e-01  
 61  -3.2808e+07  -3.2808e+07  3.02e-08  5.88e-10  1.61e-11  2.43e-02  1.78e-14  4.35e-02  
 62  -3.2808e+07  -3.2808e+07  3.02e-08  5.62e-10  1.61e-11  2.43e-02  1.76e-14  6.00e-03  
 63  -3.2808e+07  -3.2808e+07  3.01e-08  5.72e-10  1.61e-11  2.44e-02  1.74e-14  2.01e-02  
 64  -3.2808e+07  -3.2808e+07  2.98e-08  3.34e-10  1.61e-11  2.48e-02  1.83e-14  6.80e-02  
 65  -3.2808e+07  -3.2808e+07  2.98e-08  3.12e-10  1.61e-11  2.48e-02  1.82e-14  1.14e-02  
 66  -3.2808e+07  -3.2808e+07  2.97e-08  3.53e-10  1.61e-11  2.51e-02  1.78e-14  4.35e-02  
 67  -3.2808e+07  -3.2808e+07  2.85e-08  8.14e-10  1.60e-11  2.58e-02  1.72e-14  2.08e-01  
 68  -3.2808e+07  -3.2808e+07  2.84e-08  7.78e-10  1.60e-11  2.58e-02  1.70e-14  3.48e-02  
 69  -3.2808e+07  -3.2808e+07  2.75e-08  7.54e-10  1.60e-11  2.56e-02  1.67e-14  1.06e-01  
 70  -3.2808e+07  -3.2808e+07  2.69e-08  7.23e-10  1.60e-11  2.56e-02  1.64e-14  1.06e-01  
 71  -3.2808e+07  -3.2808e+07  2.66e-08  7.16e-10  1.60e-11  2.54e-02  1.65e-14  3.48e-02  
 72  -3.2808e+07  -3.2808e+07  2.53e-08  6.78e-10  1.60e-11  2.50e-02  1.58e-14  1.66e-01  
 73  -3.2809e+07  -3.2809e+07  2.36e-08  6.36e-10  1.59e-11  2.41e-02  1.49e-14  2.08e-01  
 74  -3.2808e+07  -3.2808e+07  2.29e-08  6.20e-10  1.59e-11  2.37e-02  1.46e-14  1.06e-01  
 75  -3.2809e+07  -3.2809e+07  2.03e-08  5.48e-10  1.59e-11  2.21e-02  1.35e-14  3.24e-01  
 76  -3.2809e+07  -3.2809e+07  1.99e-08  5.32e-10  1.59e-11  2.20e-02  1.34e-14  1.33e-01  
 77  -3.2809e+07  -3.2809e+07  1.98e-08  5.51e-10  1.58e-11  2.20e-02  1.32e-14  1.54e-02  
 78  -3.2809e+07  -3.2809e+07  1.79e-08  5.07e-10  1.58e-11  2.04e-02  1.22e-14  2.60e-01  
 79  -3.2809e+07  -3.2809e+07  1.69e-08  4.67e-10  1.59e-11  2.00e-02  1.37e-14  2.60e-01  
 80  -3.2809e+07  -3.2809e+07  1.69e-08  4.47e-10  1.58e-11  2.00e-02  1.32e-14  1.05e-03  
 81  -3.2809e+07  -3.2809e+07  1.69e-08  4.64e-10  1.58e-11  2.00e-02  1.29e-14  1.25e-02  
 82  -3.2809e+07  -3.2809e+07  1.68e-08  4.91e-10  1.58e-11  2.01e-02  1.32e-14  4.35e-02  
 83  -3.2809e+07  -3.2809e+07  1.67e-08  4.70e-10  1.58e-11  2.02e-02  1.28e-14  4.35e-02  
 84  -3.2809e+07  -3.2809e+07  1.62e-08  3.89e-10  1.58e-11  2.00e-02  1.39e-14  1.33e-01  
 85  -3.2809e+07  -3.2809e+07  1.61e-08  3.91e-10  1.58e-11  2.01e-02  1.34e-14  2.23e-02  
 86  -3.2809e+07  -3.2809e+07  1.60e-08  3.33e-10  1.58e-11  2.03e-02  1.31e-14  6.80e-02  
 87  -3.2809e+07  -3.2809e+07  1.51e-08  3.22e-10  1.58e-11  2.03e-02  1.58e-14  2.60e-01  
 88  -3.2809e+07  -3.2809e+07  1.51e-08  3.45e-10  1.58e-11  2.03e-02  1.50e-14  5.08e-03  
 89  -3.2809e+07  -3.2809e+07  1.51e-08  3.31e-10  1.58e-11  2.05e-02  1.49e-14  2.79e-02  
 90  -3.2809e+07  -3.2809e+07  1.50e-08  3.27e-10  1.58e-11  2.06e-02  1.43e-14  1.71e-02  
 91  -3.2809e+07  -3.2809e+07  1.47e-08  2.52e-10  1.58e-11  2.14e-02  1.74e-14  2.08e-01  
 92  -3.2809e+07  -3.2809e+07  1.47e-08  2.88e-10  1.58e-11  2.15e-02  1.58e-14  3.33e-03  
 93  -3.2809e+07  -3.2809e+07  1.47e-08  3.25e-10  1.58e-11  2.16e-02  1.50e-14  2.16e-02  
 94  -3.2809e+07  -3.2809e+07  1.46e-08  3.19e-10  1.58e-11  2.19e-02  1.49e-14  4.35e-02  
 95  -3.2809e+07  -3.2809e+07  1.45e-08  3.11e-10  1.57e-11  2.29e-02  1.47e-14  1.66e-01  
 96  -3.2809e+07  -3.2809e+07  1.45e-08  3.12e-10  1.57e-11  2.30e-02  1.49e-14  2.79e-02  
 97  -3.2809e+07  -3.2809e+07  1.44e-08  3.13e-10  1.57e-11  2.31e-02  1.47e-14  2.97e-02  
 98  -3.2809e+07  -3.2809e+07  1.41e-08  2.87e-10  1.57e-11  2.31e-02  1.45e-14  1.33e-01  
 99  -3.2809e+07  -3.2809e+07  1.28e-08  2.50e-10  1.56e-11  2.19e-02  1.36e-14  2.60e-01  
100  -3.2809e+07  -3.2809e+07  1.24e-08  2.42e-10  1.57e-11  2.19e-02  1.45e-14  2.08e-01  
101  -3.2809e+07  -3.2809e+07  1.24e-08  2.42e-10  1.56e-11  2.19e-02  1.35e-14  5.24e-04  
102  -3.2809e+07  -3.2809e+07  1.23e-08  2.41e-10  1.55e-11  2.19e-02  1.35e-14  1.30e-02  
103  -3.2809e+07  -3.2809e+07  1.23e-08  2.40e-10  1.56e-11  2.19e-02  1.35e-14  1.06e-02  
104  -3.2809e+07  -3.2809e+07  1.23e-08  2.40e-10  1.55e-11  2.19e-02  1.35e-14  1.31e-02  
105  -3.2809e+07  -3.2809e+07  1.19e-08  2.32e-10  1.54e-11  2.14e-02  1.32e-14  1.06e-01  
106  -3.2809e+07  -3.2809e+07  1.18e-08  2.32e-10  1.54e-11  2.14e-02  1.34e-14  1.78e-02  
107  -3.2809e+07  -3.2809e+07  1.16e-08  2.28e-10  1.54e-11  2.15e-02  1.41e-14  1.06e-01  
108  -3.2809e+07  -3.2809e+07  1.16e-08  2.28e-10  1.54e-11  2.15e-02  1.38e-14  2.44e-03  
109  -3.2809e+07  -3.2809e+07  1.15e-08  2.24e-10  1.54e-11  2.16e-02  1.40e-14  7.02e-02  
110  -3.2809e+07  -3.2809e+07  1.14e-08  2.22e-10  1.54e-11  2.16e-02  1.38e-14  2.79e-02  
111  -3.2810e+07  -3.2810e+07  1.04e-08  2.07e-10  1.53e-11  2.14e-02  1.46e-14  4.06e-01  
112  -3.2810e+07  -3.2810e+07  1.04e-08  2.07e-10  1.53e-11  2.15e-02  1.42e-14  2.23e-02  
113  -3.2810e+07  -3.2810e+07  1.03e-08  2.06e-10  1.53e-11  2.15e-02  1.39e-14  4.35e-02  
114  -3.2810e+07  -3.2810e+07  1.03e-08  2.05e-10  1.53e-11  2.15e-02  1.39e-14  9.13e-03  
115  -3.2810e+07  -3.2810e+07  1.03e-08  2.05e-10  1.53e-11  2.15e-02  1.39e-14  1.23e-03  
116  -3.2810e+07  -3.2810e+07  1.03e-08  2.05e-10  1.53e-11  2.15e-02  1.39e-14  0.00e+00  
"""

text_32x200 = r"""
iter    pcost        dcost       gap       pres      dres      k/t        μ       step      
---------------------------------------------------------------------------------------------
  0  +0.0000e+00  -3.8898e+09  3.89e+09  8.27e+00  8.22e-01  1.00e+00  1.00e+00   ------   
  1  -6.6426e-01  -3.8898e+09  3.89e+09  8.27e+00  3.85e-01  1.99e+00  5.01e-01  6.95e-01  
  2  -1.1466e+01  -3.8897e+09  3.39e+08  8.27e+00  3.92e-02  1.49e+01  6.71e-02  9.86e-01  
  3  -4.3638e+01  -3.8897e+09  8.91e+07  8.26e+00  9.69e-03  5.72e+01  1.75e-02  7.54e-01  
  4  -1.5980e+02  -3.8894e+09  2.43e+07  8.25e+00  2.40e-03  2.23e+02  4.49e-03  7.92e-01  
  5  -6.4763e+02  -3.8884e+09  6.00e+06  8.22e+00  5.71e-04  8.94e+02  1.12e-03  7.92e-01  
  6  -3.0118e+03  -3.8835e+09  1.29e+06  8.04e+00  1.19e-04  4.14e+03  2.41e-04  7.92e-01  
  7  -1.4075e+04  -3.8612e+09  2.74e+05  7.32e+00  2.52e-05  1.90e+04  5.20e-05  7.92e-01  
  8  -6.4867e+04  -3.7615e+09  5.80e+04  5.17e+00  5.34e-06  8.50e+04  1.12e-05  7.92e-01  
  9  -2.6234e+05  -3.4054e+09  1.30e+04  2.37e+00  1.28e-06  3.03e+05  2.70e-06  7.69e-01  
 10  -1.2799e+06  -2.1193e+09  1.65e+03  5.38e-01  2.31e-07  8.55e+05  4.77e-07  8.28e-01  
 11  -2.6782e+07  -1.6533e+09  6.07e+01  3.31e-01  1.47e-07  4.45e+05  2.99e-07  9.36e-01  
 12  -4.0095e+07  -7.5316e+08  1.78e+01  1.06e-01  4.63e-08  2.67e+05  9.44e-08  7.13e-01  
 13  -4.8323e+07  -3.2459e+08  5.72e+00  3.71e-02  1.67e-08  1.04e+05  3.37e-08  6.98e-01  
 14  -5.3667e+07  -1.6473e+08  2.07e+00  1.48e-02  7.91e-09  4.21e+04  1.48e-08  7.41e-01  
 15  -5.8303e+07  -1.0091e+08  7.31e-01  5.75e-03  3.87e-09  1.62e+04  6.69e-09  7.64e-01  
 16  -5.9916e+07  -9.0894e+07  5.17e-01  4.15e-03  3.08e-09  1.23e+04  5.19e-09  5.10e-01  
 17  -6.2090e+07  -7.2300e+07  1.64e-01  1.35e-03  1.24e-09  3.98e+03  1.89e-09  7.92e-01  
 18  -6.3232e+07  -7.0072e+07  1.08e-01  8.70e-04  8.89e-10  2.65e+03  1.25e-09  6.34e-01  
 19  -6.4078e+07  -6.6654e+07  4.02e-02  3.16e-04  4.55e-10  9.99e+02  4.78e-10  7.92e-01  
 20  -6.4943e+07  -6.6365e+07  2.19e-02  1.67e-04  3.34e-10  5.68e+02  2.70e-10  7.92e-01  
 21  -6.5456e+07  -6.6008e+07  8.43e-03  6.26e-05  2.25e-10  2.34e+02  1.09e-10  7.92e-01  
 22  -6.6115e+07  -6.6307e+07  2.91e-03  2.11e-05  1.57e-10  9.24e+01  4.32e-11  8.87e-01  
 23  -6.6356e+07  -6.6430e+07  1.11e-03  7.97e-06  1.11e-10  3.97e+01  1.86e-11  7.92e-01  
 24  -6.6611e+07  -6.6641e+07  4.51e-04  3.22e-06  8.16e-11  1.90e+01  9.27e-12  8.13e-01  
 25  -6.6744e+07  -6.6750e+07  9.71e-05  6.91e-07  6.00e-11  5.65e+00  2.50e-12  9.90e-01  
 26  -6.6831e+07  -6.6835e+07  5.03e-05  3.57e-07  5.45e-11  3.42e+00  1.71e-12  7.91e-01  
 27  -6.6837e+07  -6.6840e+07  4.35e-05  3.09e-07  5.23e-11  3.08e+00  1.53e-12  2.08e-01  
 28  -6.6866e+07  -6.6867e+07  1.65e-05  1.17e-07  4.35e-11  1.37e+00  6.87e-13  7.62e-01  
 29  -6.6882e+07  -6.6882e+07  1.10e-05  7.83e-08  4.09e-11  1.03e+00  5.31e-13  5.07e-01  
 30  -6.6902e+07  -6.6902e+07  5.21e-06  3.69e-08  3.65e-11  5.43e-01  3.02e-13  6.34e-01  
 31  -6.6910e+07  -6.6911e+07  3.79e-06  2.68e-08  3.49e-11  4.23e-01  2.47e-13  3.55e-01  
 32  -6.6912e+07  -6.6912e+07  3.55e-06  2.51e-08  3.46e-11  4.18e-01  2.42e-13  1.33e-01  
 33  -6.6927e+07  -6.6927e+07  1.25e-06  8.80e-09  3.08e-11  1.90e-01  1.16e-13  7.92e-01  
 34  -6.6931e+07  -6.6931e+07  9.87e-07  6.97e-09  3.01e-11  1.68e-01  1.05e-13  3.24e-01  
 35  -6.6933e+07  -6.6934e+07  8.27e-07  5.84e-09  2.95e-11  1.65e-01  1.01e-13  3.24e-01  
 36  -6.6935e+07  -6.6936e+07  6.88e-07  4.86e-09  2.88e-11  1.52e-01  9.51e-14  2.76e-01  
 37  -6.6938e+07  -6.6938e+07  5.31e-07  3.75e-09  2.78e-11  1.41e-01  8.81e-14  4.06e-01  
 38  -6.6939e+07  -6.6939e+07  4.56e-07  3.22e-09  2.73e-11  1.35e-01  8.46e-14  2.60e-01  
 39  -6.6942e+07  -6.6942e+07  3.39e-07  2.40e-09  2.63e-11  1.09e-01  7.21e-14  3.24e-01  
 40  -6.6944e+07  -6.6944e+07  2.68e-07  1.90e-09  2.57e-11  1.08e-01  6.76e-14  4.06e-01  
 41  -6.6944e+07  -6.6944e+07  2.55e-07  1.81e-09  2.56e-11  1.10e-01  6.81e-14  1.33e-01  
 42  -6.6946e+07  -6.6946e+07  1.88e-07  1.34e-09  2.47e-11  9.53e-02  6.02e-14  4.06e-01  
 43  -6.6947e+07  -6.6947e+07  1.63e-07  1.16e-09  2.43e-11  9.92e-02  6.02e-14  3.24e-01  
 44  -6.6947e+07  -6.6947e+07  1.56e-07  1.10e-09  2.42e-11  1.02e-01  6.06e-14  1.33e-01  
 45  -6.6948e+07  -6.6948e+07  1.44e-07  1.03e-09  2.40e-11  1.05e-01  6.09e-14  2.08e-01  
 46  -6.6948e+07  -6.6948e+07  1.32e-07  9.39e-10  2.37e-11  1.03e-01  5.94e-14  1.66e-01  
 47  -6.6949e+07  -6.6949e+07  1.18e-07  8.39e-10  2.34e-11  9.97e-02  5.76e-14  2.08e-01  
 48  -6.6951e+07  -6.6951e+07  7.84e-08  5.59e-10  2.23e-11  7.92e-02  4.71e-14  5.07e-01  
 49  -6.6951e+07  -6.6951e+07  7.15e-08  5.10e-10  2.22e-11  7.72e-02  4.58e-14  1.66e-01  
 50  -6.6952e+07  -6.6952e+07  6.23e-08  4.45e-10  2.19e-11  7.05e-02  4.27e-14  1.79e-01  
 51  -6.6953e+07  -6.6953e+07  4.17e-08  2.98e-10  2.12e-11  5.17e-02  3.36e-14  4.06e-01  
 52  -6.6954e+07  -6.6954e+07  2.82e-08  2.03e-10  2.05e-11  4.44e-02  2.95e-14  5.07e-01  
 53  -6.6955e+07  -6.6955e+07  2.62e-08  1.88e-10  2.04e-11  4.40e-02  2.91e-14  1.33e-01  
 54  -6.6955e+07  -6.6955e+07  2.14e-08  1.55e-10  2.00e-11  4.27e-02  2.80e-14  3.24e-01  
 55  -6.6956e+07  -6.6956e+07  1.88e-08  1.36e-10  1.98e-11  4.35e-02  2.77e-14  2.60e-01  
 56  -6.6956e+07  -6.6956e+07  1.88e-08  1.36e-10  1.98e-11  4.35e-02  2.77e-14  0.00e+00  
 57  -6.6956e+07  -6.6956e+07  1.88e-08  1.36e-10  1.98e-11  4.36e-02  2.64e-14  2.94e-03  
 58  -6.6956e+07  -6.6956e+07  1.88e-08  1.36e-10  1.98e-11  4.38e-02  2.71e-14  5.84e-03  
 59  -6.6956e+07  -6.6956e+07  1.88e-08  1.36e-10  1.99e-11  4.40e-02  2.49e-14  5.35e-03  
 60  -6.6956e+07  -6.6956e+07  1.88e-08  1.36e-10  1.98e-11  4.40e-02  2.43e-14  5.83e-04  
 61  -6.6956e+07  -6.6956e+07  1.88e-08  1.36e-10  1.96e-11  4.40e-02  2.43e-14  7.84e-04  
 62  -6.6956e+07  -6.6956e+07  1.88e-08  1.36e-10  1.95e-11  4.40e-02  2.45e-14  8.49e-04  
 63  -6.6956e+07  -6.6956e+07  1.88e-08  1.36e-10  1.95e-11  4.41e-02  2.46e-14  2.11e-03  
 64  -6.6956e+07  -6.6956e+07  1.87e-08  1.37e-10  1.96e-11  4.53e-02  2.43e-14  4.35e-02  
 65  -6.6956e+07  -6.6956e+07  1.87e-08  1.36e-10  1.95e-11  4.54e-02  2.43e-14  4.48e-03  
 66  -6.6956e+07  -6.6956e+07  1.87e-08  1.37e-10  1.95e-11  4.54e-02  2.44e-14  9.47e-04  
 67  -6.6956e+07  -6.6956e+07  1.87e-08  1.38e-10  1.95e-11  4.54e-02  2.44e-14  1.86e-04  
 68  -6.6956e+07  -6.6956e+07  1.85e-08  1.36e-10  1.95e-11  4.65e-02  2.53e-14  6.80e-02  
 69  -6.6956e+07  -6.6956e+07  1.84e-08  1.36e-10  1.95e-11  4.70e-02  2.56e-14  2.23e-02  
 70  -6.6956e+07  -6.6956e+07  1.83e-08  1.35e-10  1.95e-11  4.82e-02  2.65e-14  5.44e-02  
 71  -6.6956e+07  -6.6956e+07  1.79e-08  1.33e-10  1.95e-11  5.11e-02  2.86e-14  1.33e-01  
 72  -6.6956e+07  -6.6956e+07  1.79e-08  1.33e-10  1.95e-11  5.14e-02  2.80e-14  1.03e-02  
 73  -6.6956e+07  -6.6956e+07  1.78e-08  1.32e-10  1.95e-11  5.26e-02  2.72e-14  5.44e-02  
 74  -6.6956e+07  -6.6956e+07  1.76e-08  1.32e-10  1.94e-11  5.39e-02  2.70e-14  6.80e-02  
 75  -6.6956e+07  -6.6956e+07  1.75e-08  1.28e-10  1.95e-11  5.44e-02  2.69e-14  2.79e-02  
 76  -6.6956e+07  -6.6956e+07  1.74e-08  1.31e-10  1.94e-11  5.50e-02  2.81e-14  4.35e-02  
 77  -6.6956e+07  -6.6956e+07  1.72e-08  1.37e-10  1.95e-11  5.64e-02  2.73e-14  6.80e-02  
 78  -6.6956e+07  -6.6956e+07  1.70e-08  1.32e-10  1.93e-11  5.70e-02  2.75e-14  5.44e-02  
 79  -6.6956e+07  -6.6956e+07  1.69e-08  1.34e-10  1.94e-11  5.79e-02  2.80e-14  5.44e-02  
 80  -6.6956e+07  -6.6956e+07  1.68e-08  1.38e-10  1.94e-11  5.82e-02  2.80e-14  2.22e-02  
 81  -6.6956e+07  -6.6956e+07  1.59e-08  1.34e-10  1.95e-11  6.27e-02  3.14e-14  3.24e-01  
 82  -6.6956e+07  -6.6956e+07  1.59e-08  1.32e-10  1.95e-11  6.28e-02  3.09e-14  2.79e-03  
 83  -6.6956e+07  -6.6956e+07  1.59e-08  1.29e-10  1.94e-11  6.31e-02  3.01e-14  1.51e-02  
 84  -6.6956e+07  -6.6956e+07  1.59e-08  1.27e-10  1.94e-11  6.31e-02  3.00e-14  4.51e-03  
 85  -6.6956e+07  -6.6956e+07  1.57e-08  1.25e-10  1.94e-11  6.38e-02  3.04e-14  5.44e-02  
 86  -6.6956e+07  -6.6956e+07  1.55e-08  1.16e-10  1.93e-11  6.46e-02  2.93e-14  6.80e-02  
 87  -6.6956e+07  -6.6956e+07  1.54e-08  1.17e-10  1.93e-11  6.47e-02  2.94e-14  9.13e-03  
 88  -6.6956e+07  -6.6956e+07  1.46e-08  1.13e-10  1.92e-11  6.55e-02  2.74e-14  2.08e-01  
 89  -6.6956e+07  -6.6956e+07  1.39e-08  1.12e-10  1.92e-11  6.42e-02  2.61e-14  1.66e-01  
 90  -6.6956e+07  -6.6956e+07  1.35e-08  1.09e-10  1.91e-11  6.33e-02  2.61e-14  8.50e-02  
 91  -6.6956e+07  -6.6956e+07  1.30e-08  1.02e-10  1.92e-11  6.30e-02  2.70e-14  1.66e-01  
 92  -6.6956e+07  -6.6956e+07  1.30e-08  1.49e-10  1.91e-11  6.31e-02  2.70e-14  6.50e-03  
 93  -6.6956e+07  -6.6956e+07  1.28e-08  1.46e-10  1.91e-11  6.36e-02  2.64e-14  6.80e-02  
 94  -6.6956e+07  -6.6956e+07  1.28e-08  1.35e-10  1.91e-11  6.36e-02  2.64e-14  9.13e-03  
 95  -6.6956e+07  -6.6956e+07  1.22e-08  1.27e-10  1.90e-11  6.26e-02  2.54e-14  1.66e-01  
 96  -6.6956e+07  -6.6956e+07  1.21e-08  1.27e-10  1.90e-11  6.25e-02  2.54e-14  9.13e-03  
 97  -6.6956e+07  -6.6956e+07  1.21e-08  1.27e-10  1.90e-11  6.25e-02  2.54e-14  6.27e-04  
 98  -6.6956e+07  -6.6956e+07  1.21e-08  1.27e-10  1.90e-11  6.25e-02  2.54e-14  0.00e+00  
"""

def parse_iters_newsolver(text):
    """
    Parse the new solver's iteration log into a list of dicts.
    Header: iter pcost dcost gap pres dres k/t μ step
    Mapping:
      - ite <- iter
      - POBJ <- pcost
      - DOBJ <- dcost
    Other fields are kept as placeholders to reuse downstream plotting logic.
    """
    rows = []
    in_table = False
    header_re = re.compile(r"^\s*iter\s+pcost\s+dcost\s+gap\s+pres\s+dres\s+k/t\s+μ\s+step", re.IGNORECASE)
    sep_re = re.compile(r"^-{3,}|^_+")
    # Iteration data rows
    line_re = re.compile(
        r"^\s*(?P<iter>-?\d+)\s+"
        r"(?P<pcost>[+-]?(?:\d+(?:\.\d*)?|\.\d+)(?:[eE][+-]?\d+)?)\s+"
        r"(?P<dcost>[+-]?(?:\d+(?:\.\d*)?|\.\d+)(?:[eE][+-]?\d+)?)\s+"
        r"(?P<gap>[+-]?(?:\d+(?:\.\d*)?|\.\d+)(?:[eE][+-]?\d+)?)\s+"
        r"(?P<pres>[+-]?(?:\d+(?:\.\d*)?|\.\d+)(?:[eE][+-]?\d+)?)\s+"
        r"(?P<dres>[+-]?(?:\d+(?:\.\d*)?|\.\d+)(?:[eE][+-]?\d+)?)\s+"
        r"(?P<kt>[+-]?(?:\d+(?:\.\d*)?|\.\d+)(?:[eE][+-]?\d+)?)\s+"
        r"(?P<mu>[+-]?(?:\d+(?:\.\d*)?|\.\d+)(?:[eE][+-]?\d+)?)\s+"
        r"(?P<step>[+-]?(?:\d+(?:\.\d*)?|\.\d+)(?:[eE][+-]?\d+)?|\-+)\s*$"
    )
    for raw in text.splitlines():
        line = raw.rstrip("\n")
        if header_re.search(line):
            in_table = True
            continue
        if not in_table:
            continue
        if sep_re.search(line):
            continue
        if "(CVXPY)" in line:
            continue
        m = line_re.match(line)
        if not m:
            continue
        g = m.groupdict()
        try:
            step_str = g["step"].strip()
            step_val = float("nan")
            if step_str and step_str != "------":
                step_val = float(step_str)
            rows.append({
                "ite": int(g["iter"]),
                "POBJ": float(g["pcost"]),
                "DOBJ": float(g["dcost"]),
                # Placeholder/kept fields
                "PFEAS": float("nan"),
                "DFEAS": float("nan"),
                "GFEAS": float("nan"),
                "PRSTATUS": float("nan"),
                "MU": float(g["mu"]),
                "TIME": float("nan"),
                "GAP_raw": float(g["gap"]),
                "PRES_raw": float(g["pres"]),
                "DRES_raw": float(g["dres"]),
                "KT_raw": float(g["kt"]),
                "STEP_raw": step_val,
            })
        except ValueError:
            continue
    rows.sort(key=lambda r: r["ite"])
    return rows

# Put your three new solver log texts into the variables below
# Example:
# text_8x12_new = r"""<paste 8x12 new log text>"""
# text_32x100_new = r"""<paste 32x100 new log text>"""
# text_32x200_new = r"""<paste 32x200 new log text>"""
datasets = {
    "8x12": parse_iters_newsolver(text_8x12),
    "32x100": parse_iters_newsolver(text_32x100),
    "32x200": parse_iters_newsolver(text_32x200),
}

# Color mapping
colors = {
    "8x12": "tab:blue",
    "32x100": "tab:orange",
    "32x200": "tab:green",
}

# Layout: two rows and two columns, keep the first row empty; bottom row holds three plots
# (the right side uses subpanels to accommodate two plots)
fig = plt.figure(figsize=(18, 8))
# fig.suptitle("CVXPY Objectives and Primal-Dual Gap over Iterations", fontsize=14, y=0.96)

gs = GridSpec(2, 2, figure=fig, height_ratios=[1.0, 3.0], hspace=0.35, wspace=0.25)

# First row is blank
ax_empty1 = fig.add_subplot(gs[0, 0]); ax_empty1.axis("off")
ax_empty2 = fig.add_subplot(gs[0, 1]); ax_empty2.axis("off")

# Bottom-left: POBJ (single axis, as no dual-axis need for 128x4000)
ax_pobj = fig.add_subplot(gs[1, 0])
for name, data in datasets.items():
    if not data:
        continue
    x = [d["ite"] for d in data]
    y = [d["POBJ"] for d in data]
    ax_pobj.plot(x, y, marker='o', linewidth=1.5, label=name, alpha=0.9, color=colors[name])

# Keep original titles and axis labels (per "do not change names")
ax_pobj.set_title("Primal Objective (POBJ)")
ax_pobj.set_xlabel("Iteration")
ax_pobj.set_ylabel("POBJ (others)")
ax_pobj.grid(True, linestyle="--", alpha=0.4)
ax_pobj.legend(ncol=1, fontsize=8, loc="lower right")

# Bottom-right: split into two columns, left for DOBJ, right for GAP
gs_right = GridSpec(1, 2, figure=fig, wspace=0.35, left=0.55, right=0.95, bottom=0.10, top=0.86)

ax_dobj = fig.add_subplot(gs_right[0, 0])
for name, data in datasets.items():
    if not data:
        continue
    x = [d["ite"] for d in data]
    y = [d["DOBJ"] for d in data]
    ax_dobj.plot(x, y, marker='o', linewidth=1.5, label=name, alpha=0.9, color=colors[name])
ax_dobj.set_title("Dual Objective (DOBJ)")
ax_dobj.set_xlabel("Iteration")
ax_dobj.set_ylabel("Dual Objective")
ax_dobj.grid(True, linestyle="--", alpha=0.4)
ax_dobj.legend(ncol=1, fontsize=8, loc="best")

ax_gap = fig.add_subplot(gs_right[0, 1])

def _positive(vals):
    return [v if v > 0 else float("nan") for v in vals]

for name, data in datasets.items():
    if not data:
        continue
    x = [d["ite"] for d in data]
    # Relative primal-dual gap definition kept consistent with original code
    num = [abs(d["POBJ"] - d["DOBJ"]) for d in data]
    denom = [max(1.0, abs(d["DOBJ"])) for d in data]
    y = [n / m for n, m in zip(num, denom)]
    ax_gap.semilogy(x, _positive(y), marker='o', linewidth=1.5, label=name, alpha=0.9, color=colors[name])

ax_gap.set_title("Convergence Rate")
ax_gap.set_xlabel("Iteration")
ax_gap.set_ylabel("Convergence Rate")
ax_gap.grid(True, linestyle="--", alpha=0.4)
ax_gap.legend(ncol=1, fontsize=8, loc="best")

# Save
out_dir = "."
os.makedirs(out_dir, exist_ok=True)
out_path = os.path.join(out_dir, "iterative_objectives_cla.pdf")
plt.savefig(out_path, dpi=2000, bbox_inches="tight")
print(f"Saved figure to: {out_path}")
plt.close()